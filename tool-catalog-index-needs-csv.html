<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Tools & Capabilities Browser</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        :root {
            /* CHEP Brand - Primary Colours */
            --chep-dark-blue: #0A142D;
            --chep-brambles-blue: #001C66;
            --chep-blue: #0079FF;
            --chep-accent-blue: #D7DDE8;
            
            /* CHEP Brand - Secondary Colours */
            --chep-twilight: #8F29FC;
            --chep-rock: #AD5321;
            --chep-pine: #677447;
            --chep-white: #FFFFFF;
            
            /* CHEP Brand - Secondary Tints */
            --chep-purple-tint: #C77CD8;
            --chep-peach-tint: #FFA870;
            --chep-olive-tint: #9AAA6B;
            --chep-light-purple: #D3CAD9;
            --chep-light-cream: #F7D5C6;
            --chep-light-green: #D7DDCB;
            
            /* Light Theme Mappings */
            --bg-primary: #FFFFFF;
            --bg-secondary: #F8F9FB;
            --bg-tertiary: #EEF1F5;
            --bg-hover: #E4E8EE;
            --text-primary: #0A142D;
            --text-secondary: #4A5568;
            --text-muted: #718096;
            --border-color: #D7DDE8;
            --border-light: #E8ECF1;
            
            /* Accent */
            --accent-primary: #0079FF;
            --accent-hover: #0066DD;
            
            /* Support Level Colours */
            --support-none-bg: #EEF1F5;
            --support-none-text: #718096;
            --support-limited-bg: #FEE2E2;
            --support-limited-text: #991B1B;
            --support-partial-bg: #FEF3C7;
            --support-partial-text: #92400E;
            --support-full-bg: #D1FAE5;
            --support-full-text: #065F46;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Verdana, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }

        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            background: var(--bg-primary);
            min-height: 100vh;
            box-shadow: 0 0 40px rgba(10, 20, 45, 0.1);
            position: relative;
        }

        /* Tab Bar */
        .tab-bar {
            display: flex;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            padding: 0 24px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .tab-button {
            padding: 10px 20px;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            position: relative;
        }

        .tab-button:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .tab-button.active {
            color: var(--chep-blue);
            border-bottom-color: var(--chep-blue);
            background: var(--bg-primary);
        }

        .tab-button .tab-icon {
            margin-right: 6px;
        }

        /* Tab Panels */
        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Browser Panel Content */
        .browser-content {
            padding: 16px;
        }

        /* Power App Panel */
        .powerapp-panel {
            padding: 24px;
            background: var(--bg-primary);
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .powerapp-container {
            width: 100%;
            max-width: 800px;
            height: 450px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            display: block;
            background: var(--bg-primary);
        }

        .powerapp-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: calc(100vh - 120px);
            min-height: 700px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            text-align: center;
            padding: 40px;
        }

        .powerapp-placeholder-icon {
            font-size: 64px;
            margin-bottom: 24px;
            opacity: 0.5;
        }

        .powerapp-placeholder-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .powerapp-placeholder-text {
            max-width: 500px;
            line-height: 1.7;
            margin-bottom: 24px;
        }

        .powerapp-placeholder-code {
            background: var(--bg-tertiary);
            padding: 16px 24px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            color: var(--chep-blue);
            border: 1px solid var(--border-color);
            max-width: 100%;
            overflow-x: auto;
        }

        .stats-bar {
            display: flex;
            gap: 16px;
            margin-top: 12px;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--chep-blue);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Filters Panel */
        .filters-panel {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 0.8fr 0.6fr 0.6fr 0.6fr;
            gap: 10px;
            margin-bottom: 16px;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            position: sticky;
            top: 40px;
            z-index: 90;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
            min-width: 0;
        }

        .filter-label {
            font-size: 9px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            white-space: nowrap;
            padding-left: 2px;
        }

        .filter-input {
            padding: 8px 10px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 12px;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            width: 100%;
            height: 32px;
            box-sizing: border-box;
        }

        .filter-select {
            padding: 8px 10px;
            background: #ffffff;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 12px;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            width: 100%;
            height: 32px;
            box-sizing: border-box;
            cursor: pointer;
        }

        .filter-select option {
            background: #ffffff;
            color: var(--text-primary);
        }

        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: var(--chep-blue);
            box-shadow: 0 0 0 3px rgba(0, 121, 255, 0.15);
        }

        /* Multi-select dropdown */
        .multi-select {
            position: relative;
            width: 100%;
        }

        .multi-select-trigger {
            padding: 8px 28px 8px 10px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 12px;
            font-family: inherit;
            cursor: pointer;
            width: 100%;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            transition: border-color 0.2s, box-shadow 0.2s;
            height: 32px;
            box-sizing: border-box;
        }

        .multi-select-trigger::after {
            content: '';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            border: 4px solid transparent;
            border-top-color: var(--text-secondary);
        }

        .multi-select-trigger:hover,
        .multi-select.open .multi-select-trigger {
            border-color: var(--chep-blue);
        }

        .multi-select.open .multi-select-trigger {
            box-shadow: 0 0 0 3px rgba(0, 121, 255, 0.15);
        }

        .multi-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 4px;
            background: #ffffff;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            max-height: 250px;
            overflow-y: auto;
            display: none;
            min-width: 100%;
            width: max-content;
        }

        .multi-select.open .multi-select-dropdown {
            display: block;
        }

        .multi-select-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 12px;
            color: var(--text-primary);
            transition: background 0.15s;
            white-space: nowrap;
        }

        .multi-select-option:hover {
            background: var(--bg-secondary);
        }

        .multi-select-option input[type="checkbox"] {
            width: 14px;
            height: 14px;
            margin: 0;
            cursor: pointer;
            accent-color: var(--chep-blue);
        }

        .multi-select-option label {
            cursor: pointer;
            flex: 1;
            white-space: nowrap;
        }

        .multi-select-clear {
            padding: 6px 12px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 11px;
            color: var(--chep-blue);
            cursor: pointer;
            transition: background 0.15s;
        }

        .multi-select-clear:hover {
            background: var(--bg-secondary);
        }

        /* Single-select custom dropdown */
        .single-select {
            position: relative;
            width: 100%;
        }

        .single-select-trigger {
            padding: 8px 28px 8px 10px;
            background: #ffffff;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 12px;
            font-family: inherit;
            cursor: pointer;
            width: 100%;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            transition: border-color 0.2s, box-shadow 0.2s;
            height: 32px;
            box-sizing: border-box;
        }

        .single-select-trigger::after {
            content: '';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            border: 4px solid transparent;
            border-top-color: var(--text-secondary);
        }

        .single-select-trigger:hover,
        .single-select.open .single-select-trigger {
            border-color: var(--chep-blue);
        }

        .single-select.open .single-select-trigger {
            box-shadow: 0 0 0 3px rgba(0, 121, 255, 0.15);
        }

        .single-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 4px;
            background: #ffffff;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            max-height: 250px;
            overflow-y: auto;
            display: none;
            min-width: 100%;
            width: max-content;
        }

        .single-select.open .single-select-dropdown {
            display: block;
        }

        .single-select-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 12px;
            color: var(--text-primary);
            transition: background 0.15s;
            white-space: nowrap;
        }

        .single-select-option:hover {
            background: var(--bg-secondary);
        }

        .single-select-option.selected {
            background: var(--bg-secondary);
        }

        .single-select-option.selected::before {
            content: '‚úì';
            margin-right: 8px;
            color: var(--chep-blue);
            font-weight: bold;
        }

        .reset-btn {
            padding: 7px 12px;
            background: #0079FF;
            border: 1px solid #0079FF;
            border-radius: 6px;
            color: #ffffff;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            white-space: nowrap;
            height: 32px;
            box-sizing: border-box;
        }

        .reset-btn:hover {
            background: #0066dd;
            color: #ffffff;
        }

        /* View Tabs */
        .view-tabs {
            display: flex;
            gap: 2px;
            padding: 2px;
            background: var(--bg-primary);
            border-radius: 5px;
            width: 100%;
            border: 1px solid var(--border-color);
            height: 32px;
            box-sizing: border-box;
        }

        .view-tab {
            padding: 6px 10px;
            background: transparent;
            border: none;
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            flex: 1;
            text-align: center;
        }

        .view-tab:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .view-tab.active {
            background: #0079FF;
            color: white;
        }

        /* Matrix View */
        .matrix-container {
            overflow-x: auto;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .matrix-table th {
            position: sticky;
            top: 0;
            background: var(--bg-tertiary);
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
            z-index: 10;
        }

        .matrix-table th.capability-header {
            writing-mode: vertical-lr;
            text-orientation: mixed;
            transform: rotate(180deg);
            height: 180px;
            padding: 8px 4px;
            font-size: 11px;
            text-align: center;
            max-width: 36px;
        }

        .matrix-table th.tool-header {
            position: sticky;
            left: 0;
            z-index: 20;
            min-width: 200px;
        }

        .matrix-table th.proficiency-header {
            position: sticky;
            left: 200px;
            z-index: 20;
            min-width: 160px;
            background: var(--bg-tertiary);
        }

        .matrix-table td {
            padding: 8px;
            border-bottom: 1px solid var(--border-light);
            vertical-align: middle;
        }

        .matrix-table td.tool-cell {
            position: sticky;
            left: 0;
            background: var(--bg-primary);
            font-weight: 500;
            z-index: 5;
        }

        .matrix-table td.proficiency-cell {
            position: sticky;
            left: 200px;
            background: var(--bg-primary);
            z-index: 5;
        }

        .matrix-table tr:hover td {
            background: var(--bg-hover);
        }

        .matrix-table tr:hover td.tool-cell,
        .matrix-table tr:hover td.proficiency-cell {
            background: var(--bg-hover);
        }

        .tool-name-link {
            color: var(--chep-blue);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.2s;
        }

        .tool-name-link:hover {
            color: var(--chep-brambles-blue);
            text-decoration: underline;
        }

        /* Support Level Badges */
        .support-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }

        .support-0 {
            background: var(--support-none-bg);
            color: var(--support-none-text);
        }

        .support-1 {
            background: var(--support-limited-bg);
            color: var(--support-limited-text);
        }

        .support-2 {
            background: var(--support-partial-bg);
            color: var(--support-partial-text);
        }

        .support-3 {
            background: var(--support-full-bg);
            color: var(--support-full-text);
        }

        /* Proficiency Badges */
        .proficiency-badges {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .proficiency-badge {
            display: inline-flex;
            align-items: center;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .proficiency-badge.nlp {
            background: #E7FAE8;
            color: #00B050;
            border: 1px solid #c4e8c6;
        }

        .proficiency-badge.no-code {
            background: #EDEDEA;
            color: #6A734C;
            border: 1px solid #d8d8d4;
        }

        .proficiency-badge.low-code {
            background: #E9EFFF;
            color: #3477F6;
            border: 1px solid #c4d4f4;
        }

        .proficiency-badge.code-first {
            background: #E7E4EA;
            color: #8F29FC;
            border: 1px solid #d4d0d8;
        }

        .proficiency-badge.tbd {
            background: var(--bg-tertiary);
            color: var(--text-muted);
            border: 1px solid var(--border-color);
        }

        /* Cards View */
        .cards-container {
            display: none;
        }

        .cards-container.active {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .tool-card {
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            padding: 16px;
            transition: all 0.2s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }

        .tool-card:hover {
            border-color: var(--chep-blue);
            box-shadow: 0 4px 12px rgba(0, 121, 255, 0.15);
            transform: translateY(-2px);
        }

        .tool-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
            gap: 12px;
        }

        .tool-card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* TIME Status Badges */
        .time-badge {
            font-size: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            flex-shrink: 0;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .time-invest {
            background: #E7FAE8;
            color: #2E7D32;
            border: 1px solid #A5D6A7;
        }

        .time-migrate {
            background: #E3F2FD;
            color: #1565C0;
            border: 1px solid #90CAF9;
        }

        .time-tolerate {
            background: #FFF8E1;
            color: #F57F17;
            border: 1px solid #FFE082;
        }

        .time-eliminate {
            background: #FFEBEE;
            color: #C62828;
            border: 1px solid #EF9A9A;
        }

        .tool-card-proficiency {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .tool-card-description {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.5;
        }

        .tool-card-footer {
            margin-top: auto;
            padding-top: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .tool-card-cluster {
            font-size: 11px;
            color: var(--text-secondary);
        }

        .tool-card-cluster:first-child {
            flex: 1;
            min-width: 0;
        }

        .tool-card-cluster:last-child {
            flex-shrink: 0;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tool-card-cluster-label {
            color: #000000;
            font-size: 12px;
            font-weight: 700;
        }

        .tool-card-footer .time-badge {
            font-size: 9px;
            padding: 3px 6px;
        }

        .tool-card-cluster-value {
            font-weight: 700;
            color: #000000;
            font-size: 12px;
        }

        .tool-card-cluster-value.not-clustered {
            font-weight: 700;
            color: #000000;
        }

        /* Tool Detail Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 20, 45, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-primary);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(10, 20, 45, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-secondary);
            border-radius: 12px 12px 0 0;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--chep-dark-blue);
        }

        .modal-close {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            width: 36px;
            height: 36px;
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-section {
            margin-bottom: 24px;
        }

        .modal-section-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .modal-description {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .modal-link {
            color: var(--chep-blue);
            text-decoration: none;
        }

        .modal-link:hover {
            text-decoration: underline;
        }

        .modal-proficiency-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 8px;
        }

        .modal-proficiency-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-light);
        }

        .modal-proficiency-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .modal-proficiency-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .modal-proficiency-value {
            font-size: 13px;
            font-weight: 600;
        }

        .modal-proficiency-value.supported {
            color: var(--chep-pine);
        }

        .modal-proficiency-value.not-supported {
            color: var(--text-muted);
        }

        .modal-proficiency-value.tbd {
            color: var(--chep-rock);
        }

        .modal-legend {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .modal-legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .modal-capabilities-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .modal-capability-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-light);
        }

        .modal-capability-name {
            font-size: 13px;
            color: var(--text-primary);
        }

        .results-count {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .results-count strong {
            color: var(--text-primary);
        }

        /* Responsive */
        @media (max-width: 1100px) {
            .filters-panel {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 800px) {
            .filters-panel {
                grid-template-columns: repeat(2, 1fr);
            }

            .cards-container.active {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 500px) {
            .filters-panel {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                flex-wrap: wrap;
                gap: 16px;
            }

            .cards-container.active {
                grid-template-columns: 1fr;
            }

            .modal-capabilities-grid {
                grid-template-columns: 1fr;
            }

            .modal-proficiency-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .tab-button {
                padding: 12px 16px;
                font-size: 13px;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Matrix container needs specific height for scrolling */
        .matrix-wrapper {
            max-height: 70vh;
            overflow: auto;
        }

        .matrix-container.active {
            display: block;
        }

        .matrix-container {
            display: none;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Main Tab Bar -->
        <div class="tab-bar">
            <button class="tab-button active" data-tab="browser" onclick="switchMainTab('browser')">
                <span class="tab-icon">üìä</span>Capability Browser
            </button>
            <button class="tab-button" data-tab="powerapp" onclick="switchMainTab('powerapp')">
                <span class="tab-icon">üìù</span>Request a new tool
            </button>
        </div>

        <!-- Tab Panel: Capability Browser -->
        <div class="tab-panel active" id="panel-browser">
            <div class="browser-content">
                <div class="filters-panel">
                    <div class="filter-group">
                        <label class="filter-label">Technical Proficiency</label>
                        <div class="multi-select" id="proficiency-multiselect">
                            <button type="button" class="multi-select-trigger" onclick="toggleMultiSelect('proficiency-multiselect')">All interface types</button>
                            <div class="multi-select-dropdown">
                                <div class="multi-select-option">
                                    <input type="checkbox" id="prof-nlp" value="nlp" onchange="updateMultiSelect('proficiency-multiselect')">
                                    <label for="prof-nlp">Natural Language</label>
                                </div>
                                <div class="multi-select-option">
                                    <input type="checkbox" id="prof-noCode" value="noCode" onchange="updateMultiSelect('proficiency-multiselect')">
                                    <label for="prof-noCode">No-Code</label>
                                </div>
                                <div class="multi-select-option">
                                    <input type="checkbox" id="prof-lowCode" value="lowCode" onchange="updateMultiSelect('proficiency-multiselect')">
                                    <label for="prof-lowCode">Low-Code</label>
                                </div>
                                <div class="multi-select-option">
                                    <input type="checkbox" id="prof-codeFirst" value="codeFirst" onchange="updateMultiSelect('proficiency-multiselect')">
                                    <label for="prof-codeFirst">Code-First</label>
                                </div>
                                <div class="multi-select-clear" onclick="clearMultiSelect('proficiency-multiselect')">Clear selection</div>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Job Family</label>
                        <div class="single-select" id="jobfamily-select">
                            <button type="button" class="single-select-trigger" onclick="toggleSingleSelect('jobfamily-select')">All Job Families</button>
                            <div class="single-select-dropdown">
                                <div class="single-select-option selected" data-value="" onclick="selectSingleOption('jobfamily-select', '', 'All Job Families')">All Job Families</div>
                                <div class="single-select-option" data-value="Data Science & Machine Learning" onclick="selectSingleOption('jobfamily-select', 'Data Science & Machine Learning', 'Data Science & Machine Learning')">Data Science & Machine Learning</div>
                                <div class="single-select-option" data-value="Data Engineering" onclick="selectSingleOption('jobfamily-select', 'Data Engineering', 'Data Engineering')">Data Engineering</div>
                                <div class="single-select-option" data-value="Visualisation Engineering" onclick="selectSingleOption('jobfamily-select', 'Visualisation Engineering', 'Visualisation Engineering')">Visualisation Engineering</div>
                                <div class="single-select-option" data-value="Data & Insights Analysis" onclick="selectSingleOption('jobfamily-select', 'Data & Insights Analysis', 'Data & Insights Analysis')">Data & Insights Analysis</div>
                                <div class="single-select-option" data-value="Software Development" onclick="selectSingleOption('jobfamily-select', 'Software Development', 'Software Development')">Software Development</div>
                                <div class="single-select-option" data-value="Robotic Process Engineering (RPA)" onclick="selectSingleOption('jobfamily-select', 'Robotic Process Engineering (RPA)', 'Robotic Process Engineering (RPA)')">Robotic Process Engineering (RPA)</div>
                                <div class="single-select-option" data-value="Product Management" onclick="selectSingleOption('jobfamily-select', 'Product Management', 'Product Management')">Product Management</div>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Capability Family</label>
                        <div class="multi-select" id="capability-multiselect">
                            <button type="button" class="multi-select-trigger" onclick="toggleMultiSelect('capability-multiselect')">All Capabilities</button>
                            <div class="multi-select-dropdown" id="capability-dropdown">
                                <!-- Options populated by JavaScript -->
                                <div class="multi-select-clear" onclick="clearMultiSelect('capability-multiselect')">Clear selection</div>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Search Tools</label>
                        <input type="text" class="filter-input" id="search-input" placeholder="Search by tool name...">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">License Type</label>
                        <div class="single-select" id="license-select">
                            <button type="button" class="single-select-trigger" onclick="toggleSingleSelect('license-select')">All Types</button>
                            <div class="single-select-dropdown">
                                <div class="single-select-option selected" data-value="" onclick="selectSingleOption('license-select', '', 'All Types')">All Types</div>
                                <div class="single-select-option" data-value="Commercial" onclick="selectSingleOption('license-select', 'Commercial', 'Commercial')">Commercial</div>
                                <div class="single-select-option" data-value="Open-source" onclick="selectSingleOption('license-select', 'Open-source', 'Open Source')">Open Source</div>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Overlap Clusters</label>
                        <div class="single-select" id="cluster-select">
                            <button type="button" class="single-select-trigger" onclick="toggleSingleSelect('cluster-select')">All</button>
                            <div class="single-select-dropdown" id="cluster-dropdown">
                                <div class="single-select-option selected" data-value="" onclick="selectSingleOption('cluster-select', '', 'All')">All</div>
                                <div class="single-select-option" data-value="none" onclick="selectSingleOption('cluster-select', 'none', 'None')">None</div>
                                <!-- Additional options populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">View</label>
                        <div class="view-tabs">
                            <button class="view-tab active" data-view="cards" onclick="switchView('cards')">Card</button>
                            <button class="view-tab" data-view="matrix" onclick="switchView('matrix')">Matrix</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">&nbsp;</label>
                        <button class="reset-btn" onclick="resetFilters()">Reset Filters</button>
                    </div>
                </div>

                <div class="results-count">
                    Showing <strong id="filtered-count">0</strong> of <strong id="total-count">0</strong> tools
                </div>

                <!-- Cards View -->
                <div class="cards-container active" id="cards-view"></div>

                <!-- Matrix View -->
                <div class="matrix-container" id="matrix-view">
                    <div class="matrix-wrapper">
                        <table class="matrix-table" id="matrix-table">
                            <thead id="matrix-head"></thead>
                            <tbody id="matrix-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Stats Bar (Bottom) -->
                <div class="stats-bar" style="margin-top: 24px;">
                    <div class="stat-item">
                        <span class="stat-value" id="total-tools">0</span>
                        <span class="stat-label">Tools</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="total-capabilities">26</span>
                        <span class="stat-label">Capability Families</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="commercial-count">0</span>
                        <span class="stat-label">Commercial</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="opensource-count">0</span>
                        <span class="stat-label">Open Source</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="proficiency-mapped">0</span>
                        <span class="stat-label">Technical Proficiency Mapped</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Panel: Power App -->
        <div class="tab-panel" id="panel-powerapp">
            <div class="powerapp-panel">
                <!-- 
                    ============================================================
                    POWER APP INTEGRATION
                    ============================================================
                    
                    Replace the placeholder below with your Power App iframe.
                    
                    To get your Power App embed URL:
                    1. Go to Power Apps (make.powerapps.com)
                    2. Select your app
                    3. Click "..." ‚Üí "Details" 
                    4. Copy the "Web link" 
                    
                    Then replace the powerapp-placeholder div with:
                    
                    <iframe 
                        src="https://apps.powerapps.com/play/e/YOUR-APP-ID?tenantId=YOUR-TENANT-ID"
                        class="powerapp-container"
                        frameborder="0"
                        allowfullscreen>
                    </iframe>
                    
                    ============================================================
                -->
                <iframe 
                    src="https://apps.powerapps.com/play/e/default-7c4f77bb-bc61-4789-8aca-54aa04ebb634/a/294c5c07-cc11-4ab4-aea7-b9215f7726bf?tenantId=7c4f77bb-bc61-4789-8aca-54aa04ebb634&hint=02cab763-4c70-4c89-9c64-25cd14f30d23&sourcetime=1769797160490"
                    class="powerapp-container"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            </div>
        </div>
    </div>

    <!-- Tool Detail Modal -->
    <div class="modal-overlay" id="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Tool Name</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h3 class="modal-section-title">Description</h3>
                    <p class="modal-description" id="modal-description"></p>
                </div>
                <div class="modal-section">
                    <h3 class="modal-section-title">Details</h3>
                    <p><strong>License:</strong> <span id="modal-license"></span></p>
                    <p><strong>End state</strong> <span id="modal-time"></span></p>
                    <p><strong>Overlap cluster:</strong> <span id="modal-cluster"></span></p>
                    <p><strong>Website:</strong> <a class="modal-link" id="modal-url" href="#" target="_blank"></a></p>
                </div>
                <div class="modal-section">
                    <h3 class="modal-section-title">Support Level Legend</h3>
                    <div class="modal-legend">
                        <div class="modal-legend-item">
                            <span class="support-badge support-0">0</span>
                            <span>None</span>
                        </div>
                        <div class="modal-legend-item">
                            <span class="support-badge support-1">1</span>
                            <span>Limited</span>
                        </div>
                        <div class="modal-legend-item">
                            <span class="support-badge support-2">2</span>
                            <span>Partial</span>
                        </div>
                        <div class="modal-legend-item">
                            <span class="support-badge support-3">3</span>
                            <span>Full</span>
                        </div>
                    </div>
                </div>
                <div class="modal-section">
                    <h3 class="modal-section-title">Technical Proficiency</h3>
                    <div class="modal-proficiency-grid" id="modal-proficiency"></div>
                </div>
                <div class="modal-section">
                    <h3 class="modal-section-title">Capability Support</h3>
                    <div class="modal-capabilities-grid" id="modal-capabilities"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Capability names in order
        const CAPABILITY_NAMES = [
            "Advanced Visualisation Techniques",
            "AI Application Development",
            "Business Intelligence Analysis",
            "Computer Vision Applications",
            "Dashboard & Report Development",
            "Data Ingestion & Processing",
            "Data Modelling & Schema",
            "Data Product Design & User Experience",
            "Data Product Development",
            "Data Product Operations & Support",
            "Data Transformation & Quality",
            "Decision Support Systems",
            "Forecasting & Planning",
            "Governance & Compliance",
            "LLM Development & Operations",
            "Machine Learning Development",
            "Model Deployment & Serving",
            "Model Lifecycle Management",
            "Modelling Governance",
            "Pattern Recognition & Anomaly Detection",
            "Process Management",
            "SQL & Code Optimisation",
            "Specialised ML Applications",
            "Specialised Visualisation Applications",
            "Data Observability",
            "Process Automation"
        ];

        const SUPPORT_LABELS = {
            0: "None",
            1: "Limited",
            2: "Partial",
            3: "Full"
        };

        const PROFICIENCY_LABELS = {
            nlp: "Natural Language",
            noCode: "No-Code",
            lowCode: "Low-Code",
            codeFirst: "Code-First"
        };

        const PROFICIENCY_ICONS = {
            nlp: "üí¨",
            noCode: "üñ±Ô∏è",
            lowCode: "‚öôÔ∏è",
            codeFirst: "üíª"
        };

        // TIME Status values (Gartner TIME framework)
        const TIME_VALUES = ['TOLERATE', 'INVEST', 'MIGRATE', 'ELIMINATE'];
        
        // Job Family values
        const JOB_FAMILIES = [
            'Data Science & Machine Learning',
            'Data Engineering',
            'Visualisation Engineering',
            'Data & Insights Analysis',
            'Software Development',
            'Robotic Process Engineering (RPA)',
            'Product Management'
        ];
        
        // Functions to get TIME status and Job Family from tool data
        // These now read from the CSV data instead of generating randomly
        function getTimeStatus(toolName) {
            const tool = TOOLS_DATA.find(t => t.name === toolName);
            return tool ? tool.timeStatus : 'TBD';
        }

        function getJobFamily(toolName) {
            const tool = TOOLS_DATA.find(t => t.name === toolName);
            return tool ? tool.jobFamily : '';
        }

        // Function to get Consolidation Cluster for a tool
        function getCluster(toolName) {
            const tool = TOOLS_DATA.find(t => t.name === toolName);
            return tool ? tool.cluster : '';
        }

        // Get list of all unique clusters for filter dropdown
        function getUniqueClusters() {
            const clusters = new Set();
            TOOLS_DATA.forEach(tool => {
                if (tool.cluster) clusters.add(tool.cluster);
            });
            return Array.from(clusters).sort();
        }

        // Tool data - will be loaded from CSV
        let TOOLS_DATA = [];

        // CSV column mapping for capabilities (in order)
        const CAPABILITY_COLUMNS = [
            'cap_advanced_visualisation_techniques',
            'cap_ai_application_development',
            'cap_business_intelligence_analysis',
            'cap_computer_vision_applications',
            'cap_dashboard_report_development',
            'cap_data_ingestion_processing',
            'cap_data_modelling_schema',
            'cap_data_product_design_user_experience',
            'cap_data_product_development',
            'cap_data_product_operations_support',
            'cap_data_transformation_quality',
            'cap_decision_support_systems',
            'cap_forecasting_planning',
            'cap_governance_compliance',
            'cap_llm_development_operations',
            'cap_machine_learning_development',
            'cap_model_deployment_serving',
            'cap_model_lifecycle_management',
            'cap_modelling_governance',
            'cap_pattern_recognition_anomaly_detection',
            'cap_process_management',
            'cap_sql_code_optimisation',
            'cap_specialised_ml_applications',
            'cap_specialised_visualisation_applications',
            'cap_data_observability',
            'cap_process_automation'
        ];

        // Function to parse CSV row into tool object
        function parseToolFromCSV(row) {
            // Parse proficiency values
            const parseProficiency = (val) => {
                if (val === 'TRUE') return true;
                if (val === 'FALSE') return false;
                return null; // TBD
            };

            // Parse capabilities array
            const capabilities = CAPABILITY_COLUMNS.map(col => parseInt(row[col]) || 0);

            return {
                name: row.tool_name,
                status: row.license_type,
                description: row.description,
                url: row.url,
                timeStatus: row.time_status,
                jobFamily: row.job_family,
                cluster: row.cluster || '',
                capabilities: capabilities,
                proficiency: {
                    nlp: parseProficiency(row.prof_nlp),
                    noCode: parseProficiency(row.prof_no_code),
                    lowCode: parseProficiency(row.prof_low_code),
                    codeFirst: parseProficiency(row.prof_code_first)
                }
            };
        }

        // Load data from CSV file
        function loadToolsData() {
            return new Promise((resolve, reject) => {
                // Try to load from same directory as HTML file
                const csvPath = 'tools_data.csv';
                
                Papa.parse(csvPath, {
                    download: true,
                    header: true,
                    skipEmptyLines: true,
                    complete: function(results) {
                        if (results.errors.length > 0) {
                            console.warn('CSV parsing warnings:', results.errors);
                        }
                        TOOLS_DATA = results.data.map(parseToolFromCSV);
                        console.log(`Loaded ${TOOLS_DATA.length} tools from CSV`);
                        resolve(TOOLS_DATA);
                    },
                    error: function(error) {
                        console.error('Error loading CSV:', error);
                        reject(error);
                    }
                });
            });
        }

        // State
        let filteredTools = [];
        let currentView = 'cards';
        let powerAppLoaded = false;

        // Initialize - load CSV first, then set up UI
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Show loading state
                document.getElementById('cards-view').innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-muted);">Loading tools data...</div>';
                
                // Load data from CSV
                await loadToolsData();
                
                // Initialize UI after data is loaded
                filteredTools = [...TOOLS_DATA];
                populateCapabilityFilter();
                populateClusterFilter();
                updateStats();
                applyFilters();
            } catch (error) {
                console.error('Failed to load tools data:', error);
                document.getElementById('cards-view').innerHTML = '<div style="text-align: center; padding: 40px; color: #991B1B;">Error loading tools data. Please check that tools_data.csv is in the same directory.</div>';
            }
        });

        // Main Tab Switching
        function switchMainTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabName);
            });

            // Update panels
            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById('panel-' + tabName).classList.add('active');

            // Lazy load Power App iframe on first visit
            if (tabName === 'powerapp' && !powerAppLoaded) {
                // Uncomment and modify this when you have your Power App URL:
                // loadPowerApp('https://apps.powerapps.com/play/e/YOUR-APP-ID?tenantId=YOUR-TENANT');
                powerAppLoaded = true;
            }
        }

        function loadPowerApp(url) {
            const container = document.querySelector('.powerapp-panel');
            container.innerHTML = `
                <iframe 
                    src="${url}"
                    class="powerapp-container"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            `;
        }

        function populateCapabilityFilter() {
            const dropdown = document.getElementById('capability-dropdown');
            const clearBtn = dropdown.querySelector('.multi-select-clear');
            
            CAPABILITY_NAMES.forEach((name, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'multi-select-option';
                optionDiv.innerHTML = `
                    <input type="checkbox" id="cap-${index}" value="${index}" onchange="updateMultiSelect('capability-multiselect')">
                    <label for="cap-${index}">${name}</label>
                `;
                dropdown.insertBefore(optionDiv, clearBtn);
            });
        }

        // Multi-select functions
        function toggleMultiSelect(id) {
            const multiSelect = document.getElementById(id);
            const wasOpen = multiSelect.classList.contains('open');
            
            // Close all other multi-selects
            document.querySelectorAll('.multi-select.open').forEach(ms => {
                ms.classList.remove('open');
            });
            
            // Toggle this one
            if (!wasOpen) {
                multiSelect.classList.add('open');
            }
        }

        function updateMultiSelect(id) {
            const multiSelect = document.getElementById(id);
            const checkboxes = multiSelect.querySelectorAll('input[type="checkbox"]:checked');
            const trigger = multiSelect.querySelector('.multi-select-trigger');
            
            if (checkboxes.length === 0) {
                trigger.textContent = id === 'proficiency-multiselect' ? 'All interface types' : 'All Capabilities';
            } else if (checkboxes.length === 1) {
                const label = multiSelect.querySelector(`label[for="${checkboxes[0].id}"]`);
                trigger.textContent = label.textContent;
            } else {
                trigger.textContent = `${checkboxes.length} selected`;
            }
            
            applyFilters();
        }

        function clearMultiSelect(id) {
            const multiSelect = document.getElementById(id);
            multiSelect.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });
            updateMultiSelect(id);
        }

        function getMultiSelectValues(id) {
            const multiSelect = document.getElementById(id);
            const checkboxes = multiSelect.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        // Single-select functions
        function toggleSingleSelect(id) {
            const singleSelect = document.getElementById(id);
            const wasOpen = singleSelect.classList.contains('open');
            
            // Close all other single-selects and multi-selects
            document.querySelectorAll('.single-select.open, .multi-select.open').forEach(s => {
                s.classList.remove('open');
            });
            
            // Toggle this one
            if (!wasOpen) {
                singleSelect.classList.add('open');
            }
        }

        function selectSingleOption(id, value, label) {
            const singleSelect = document.getElementById(id);
            const trigger = singleSelect.querySelector('.single-select-trigger');
            
            // Update selected state
            singleSelect.querySelectorAll('.single-select-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.value === value) {
                    opt.classList.add('selected');
                }
            });
            
            // Update trigger text
            trigger.textContent = label;
            
            // Store selected value
            singleSelect.dataset.value = value;
            
            // Close dropdown
            singleSelect.classList.remove('open');
            
            // Apply filters
            applyFilters();
        }

        function getSingleSelectValue(id) {
            const singleSelect = document.getElementById(id);
            return singleSelect.dataset.value || '';
        }

        function resetSingleSelect(id, defaultLabel) {
            const singleSelect = document.getElementById(id);
            const trigger = singleSelect.querySelector('.single-select-trigger');
            
            singleSelect.querySelectorAll('.single-select-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.value === '') {
                    opt.classList.add('selected');
                }
            });
            
            trigger.textContent = defaultLabel;
            singleSelect.dataset.value = '';
        }

        // Close multi-selects and single-selects when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.multi-select') && !e.target.closest('.single-select')) {
                document.querySelectorAll('.multi-select.open, .single-select.open').forEach(ms => {
                    ms.classList.remove('open');
                });
            }
        });

        // Close multi-selects and single-selects when pressing ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.multi-select.open, .single-select.open').forEach(ms => {
                    ms.classList.remove('open');
                });
            }
        });

        function updateStats() {
            const commercialCount = TOOLS_DATA.filter(t => t.status === 'Commercial').length;
            const opensourceCount = TOOLS_DATA.filter(t => t.status === 'Open-source').length;
            const proficiencyMapped = TOOLS_DATA.filter(t => {
                const p = t.proficiency;
                return p.nlp !== null || p.noCode !== null || p.lowCode !== null || p.codeFirst !== null;
            }).length;
            
            document.getElementById('total-tools').textContent = TOOLS_DATA.length;
            document.getElementById('commercial-count').textContent = commercialCount;
            document.getElementById('opensource-count').textContent = opensourceCount;
            document.getElementById('total-count').textContent = TOOLS_DATA.length;
            document.getElementById('proficiency-mapped').textContent = proficiencyMapped;
        }

        function applyFilters() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const selectedCapabilities = getMultiSelectValues('capability-multiselect');
            const jobFamily = getSingleSelectValue('jobfamily-select');
            const licenseType = getSingleSelectValue('license-select');
            const selectedProficiencies = getMultiSelectValues('proficiency-multiselect');
            const clusterFilter = getSingleSelectValue('cluster-select');

            filteredTools = TOOLS_DATA.filter(tool => {
                if (searchTerm && !tool.name.toLowerCase().includes(searchTerm)) {
                    return false;
                }
                if (licenseType && tool.status !== licenseType) {
                    return false;
                }
                if (jobFamily && getJobFamily(tool.name) !== jobFamily) {
                    return false;
                }
                if (clusterFilter) {
                    const toolCluster = getCluster(tool.name);
                    if (clusterFilter === 'none') {
                        // Filter for tools NOT in any cluster
                        if (toolCluster !== '') {
                            return false;
                        }
                    } else {
                        // Filter for specific cluster
                        if (toolCluster !== clusterFilter) {
                            return false;
                        }
                    }
                }
                // Proficiency filter - tool must support AT LEAST ONE of the selected modes (OR logic)
                if (selectedProficiencies.length > 0) {
                    const hasAnyProficiency = selectedProficiencies.some(mode => tool.proficiency[mode] === true);
                    if (!hasAnyProficiency) {
                        return false;
                    }
                }
                // Capability filter - tool must support ALL selected capabilities (AND logic)
                if (selectedCapabilities.length > 0) {
                    const hasAllCapabilities = selectedCapabilities.every(capIndex => {
                        return tool.capabilities[parseInt(capIndex)] > 0;
                    });
                    if (!hasAllCapabilities) {
                        return false;
                    }
                }
                return true;
            });

            document.getElementById('filtered-count').textContent = filteredTools.length;
            renderCurrentView();
        }

        function renderProficiencyBadges(proficiency) {
            const badges = [];
            
            if (proficiency.nlp === true) {
                badges.push(`<span class="proficiency-badge nlp">Natural Language</span>`);
            }
            if (proficiency.noCode === true) {
                badges.push(`<span class="proficiency-badge no-code">No-Code</span>`);
            }
            if (proficiency.lowCode === true) {
                badges.push(`<span class="proficiency-badge low-code">Low-Code</span>`);
            }
            if (proficiency.codeFirst === true) {
                badges.push(`<span class="proficiency-badge code-first">Code-First</span>`);
            }
            
            const allNull = Object.values(proficiency).every(v => v === null);
            if (allNull) {
                badges.push(`<span class="proficiency-badge tbd">TBD</span>`);
            }
            
            if (badges.length === 0) {
                const hasAnyTrue = Object.values(proficiency).some(v => v === true);
                if (!hasAnyTrue) {
                    if (proficiency.nlp === null) badges.push(`<span class="proficiency-badge tbd" title="Natural Language: TBD">?</span>`);
                }
            }

            return badges.join('');
        }

        function renderCurrentView() {
            if (currentView === 'cards') {
                renderCardsView();
            } else {
                renderMatrixView();
            }
        }

        function renderCardsView() {
            const container = document.getElementById('cards-view');
            
            if (filteredTools.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div class="empty-state-title">No tools match your filters</div>
                        <p>Try adjusting your search criteria or reset filters</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredTools.map(tool => {
                const timeStatus = getTimeStatus(tool.name);
                const cluster = getCluster(tool.name);

                return `
                    <div class="tool-card" onclick="openToolModal('${tool.name.replace(/'/g, "\\'")}')">
                        <div class="tool-card-header">
                            <span class="tool-card-title">${tool.name}</span>
                        </div>
                        <div class="tool-card-proficiency">
                            ${renderProficiencyBadges(tool.proficiency)}
                        </div>
                        <p class="tool-card-description">${tool.description}</p>
                        <div class="tool-card-footer">
                            <div class="tool-card-cluster">
                                <span class="tool-card-cluster-label">Overlap cluster: </span>
                                <span class="tool-card-cluster-value ${cluster ? '' : 'not-clustered'}">${cluster ? cluster : 'None'}</span>
                            </div>
                            <div class="tool-card-cluster">
                                <span class="tool-card-cluster-label">End state </span>
                                <span class="time-badge time-${timeStatus.toLowerCase()}">${timeStatus}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderMatrixView() {
            const thead = document.getElementById('matrix-head');
            const tbody = document.getElementById('matrix-body');

            thead.innerHTML = `
                <tr>
                    <th class="tool-header">Tool</th>
                    <th class="proficiency-header">Technical Proficiency</th>
                    ${CAPABILITY_NAMES.map(name => `<th class="capability-header" title="${name}">${name}</th>`).join('')}
                </tr>
            `;

            if (filteredTools.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="${CAPABILITY_NAMES.length + 2}" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            No tools match your filters
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filteredTools.map(tool => `
                <tr>
                    <td class="tool-cell">
                        <a class="tool-name-link" onclick="openToolModal('${tool.name.replace(/'/g, "\\'")}')">${tool.name}</a>
                    </td>
                    <td class="proficiency-cell">
                        <div class="proficiency-badges">
                            ${renderProficiencyBadges(tool.proficiency)}
                        </div>
                    </td>
                    ${tool.capabilities.map(level => `
                        <td style="text-align: center;">
                            <span class="support-badge support-${level}" title="${SUPPORT_LABELS[level]}">${level}</span>
                        </td>
                    `).join('')}
                </tr>
            `).join('');
        }

        function switchView(view) {
            currentView = view;
            
            document.querySelectorAll('.view-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.view === view);
            });

            document.getElementById('cards-view').classList.toggle('active', view === 'cards');
            document.getElementById('matrix-view').classList.toggle('active', view === 'matrix');

            renderCurrentView();
        }

        function openToolModal(toolName) {
            const tool = TOOLS_DATA.find(t => t.name === toolName);
            if (!tool) return;

            const timeStatus = getTimeStatus(tool.name);
            const cluster = getCluster(tool.name);

            document.getElementById('modal-title').textContent = tool.name;
            document.getElementById('modal-description').textContent = tool.description;
            document.getElementById('modal-license').textContent = tool.status;
            document.getElementById('modal-time').innerHTML = `<span class="time-badge time-${timeStatus.toLowerCase()}">${timeStatus}</span>`;
            document.getElementById('modal-cluster').textContent = cluster ? cluster : 'None';
            
            const urlElement = document.getElementById('modal-url');
            urlElement.href = tool.url;
            urlElement.textContent = tool.url;

            const proficiencyContainer = document.getElementById('modal-proficiency');
            proficiencyContainer.innerHTML = Object.entries(tool.proficiency).map(([key, value]) => {
                let valueClass, valueText;
                if (value === true) {
                    valueClass = 'supported';
                    valueText = '‚úì Supported';
                } else if (value === false) {
                    valueClass = 'not-supported';
                    valueText = '‚úó Not Available';
                } else {
                    valueClass = 'tbd';
                    valueText = '? TBD';
                }
                
                return `
                    <div class="modal-proficiency-item">
                        <span class="modal-proficiency-icon">${PROFICIENCY_ICONS[key]}</span>
                        <span class="modal-proficiency-label">${PROFICIENCY_LABELS[key]}</span>
                        <span class="modal-proficiency-value ${valueClass}">${valueText}</span>
                    </div>
                `;
            }).join('');

            const capabilitiesContainer = document.getElementById('modal-capabilities');
            capabilitiesContainer.innerHTML = CAPABILITY_NAMES.map((name, index) => `
                <div class="modal-capability-item">
                    <span class="modal-capability-name">${name}</span>
                    <span class="support-badge support-${tool.capabilities[index]}">${tool.capabilities[index]}</span>
                </div>
            `).join('');

            document.getElementById('tool-modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('tool-modal').classList.remove('active');
        }

        function resetFilters() {
            document.getElementById('search-input').value = '';
            resetSingleSelect('jobfamily-select', 'All Job Families');
            resetSingleSelect('license-select', 'All Types');
            resetSingleSelect('cluster-select', 'All');
            clearMultiSelect('proficiency-multiselect');
            clearMultiSelect('capability-multiselect');
        }

        // Populate cluster filter dropdown
        function populateClusterFilter() {
            const dropdown = document.getElementById('cluster-dropdown');
            const clusters = getUniqueClusters();
            clusters.forEach(cluster => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'single-select-option';
                optionDiv.dataset.value = cluster;
                optionDiv.textContent = cluster;
                optionDiv.onclick = function() {
                    selectSingleOption('cluster-select', cluster, cluster);
                };
                dropdown.appendChild(optionDiv);
            });
        }

        // Event listeners
        document.getElementById('search-input').addEventListener('input', applyFilters);

        document.getElementById('tool-modal').addEventListener('click', (e) => {
            if (e.target.id === 'tool-modal') {
                closeModal();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>
